<h1 id="физическая-таблица">Физическая таблица</h1>

<p><em>Физическая таблица</em> — таблица СУБД <a href="../Хранилище_данных/Хранилище_данных.md">хранилища</a>, каждая запись 
которой описывает состояние объекта <a href="../Логическая_таблица/Логическая_таблица.md">логической таблицы</a> 
в определенный период времени. В зависимости от <a href="../Физическая_схема_данных/Физическая_схема_данных.md">типа физической таблицы</a> 
состояние объектов, хранящееся в ней, может быть новым (“горячим”), актуальным или архивным.</p>

<p>Все данные, загруженные в систему, до фиксации изменений считаются новым состоянием объектов и хранятся 
в виде горячих записей. При фиксации изменений система одномоментно обновляет состояние объектов, 
исключая возможность чтения грязных данных. Обновление происходит в следующем порядке:</p>
<ol>
  <li>Сравниваются новое и актуальное состояния объектов.</li>
  <li>Определяется, какие записи нужно добавить (если таких объектов нет среди актуальных данных), а какие — 
заменить новыми (если объекты уже есть в системе, и нужно обновить их состояние).</li>
  <li>Состояние новых объектов фиксируется в виде актуальных записей.</li>
  <li>Для существующих объектов записи, которые считались актуальными до момента фиксации изменений, 
перемещаются в категорию архивных, а новое состояние объектов фиксируется в виде актуальных записей.</li>
  <li>Все горячие записи удаляются.</li>
  <li>В историю изменений состояния системы добавляется новая <a href="../Дельта/Дельта.md">дельта</a> с номером, 
увеличенным на 1 относительно предыдущей зафиксированной дельты.</li>
</ol>

<p>На рисунке ниже показан пример обновления состояния объекта — набора данных одного клиента. В примере 
рассматривается следующая ситуация: номер телефона клиента был ранее изменен со значения <code class="language-sql highlighter-rouge"><span class="n">phone_1</span></code> 
на <code class="language-sql highlighter-rouge"><span class="n">phone_2</span></code>, это изменение было зафиксировано, и теперь загружаются данные того же клиента с новым адресом 
(<code class="language-sql highlighter-rouge"><span class="n">address_2</span></code>).</p>

<p class="figure-center"><img src="Физическая_таблица.svg" alt="" /></p>
<p class="figure-caption-center"><em>Обновление данных клиента</em></p>

<p>В условиях, рассмотренных в примере, данные клиента обновляются в следующем порядке:</p>
<ol>
  <li>Загрузка данных: запись с новым адресом (<code class="language-sql highlighter-rouge"><span class="n">address_2</span></code>) сохраняется в качестве горячей записи.</li>
  <li>Фиксация изменений данных: запись с предыдущим адресом (<code class="language-sql highlighter-rouge"><span class="n">address_1</span></code>) переносится в категорию архивных, 
запись с новым адресом (<code class="language-sql highlighter-rouge"><span class="n">address_2</span></code>) — в категорию актуальных, и горячая запись удаляется. 
Обновление записей происходит одномоментно.</li>
</ol>
