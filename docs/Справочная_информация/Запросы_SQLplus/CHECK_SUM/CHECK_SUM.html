<h1 id="check_sum">CHECK_SUM</h1>

<p>Запрос позволяет проверить равенство контрольных сумм для указанной <a href="../../../Обзор_понятий_компонентов_и_связей/Основные_понятия/Дельта/Дельта.md">дельты</a> 
в различных СУБД хранилища и, тем самым, проверить идентичность данных в этих СУБД.</p>

<p>Доступны следующие области проверки:</p>
<ul>
  <li>все <a href="../../../Обзор_понятий_компонентов_и_связей/Основные_понятия/Логическая_таблица/Логическая_таблица.md">логические таблицы</a> 
<a href="../../../Обзор_понятий_компонентов_и_связей/Основные_понятия/Логическая_база_данных/Логическая_база_данных.md">логической базы данных</a>,</li>
  <li>все столбцы логической таблицы,</li>
  <li>отдельные столбцы логической таблицы.</li>
</ul>

<p>Проверка контрольной суммы данных каждой логической таблицы производится сравнением контрольных сумм, 
вычисленных по соответствующим данным, содержащимся в каждой из целевых СУБД.</p>

<p>Контрольная сумма данных формируется по хеш-функции от символьной контрольной строки для этих данных. 
Контрольная строка для данных всех логических таблиц формируется конкатенацией контрольных строк для 
данных каждой таблицы. Контрольная строка для данных таблицы формируется конкатенацией контрольных сумм
для данных в столбцах из указанного списка. Контрольные суммы для данных в столбцах сопоставляются между 
целевыми СУБД.</p>

<p>В ответе возвращается:</p>
<ul>
  <li>64-битное неотрицательное целочисленное значение совпадающих контрольных сумм указанных данных 
в разных СУБД, при успешном выполнении запроса;</li>
  <li>сообщение о несовпадении контрольных сумм указанных данных в разных СУБД при успешном выполнении 
запроса или сообщение о неуспешном выполнении запроса.</li>
</ul>

<h2 id="синтаксис">Синтаксис</h2>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CHECK_SUM</span><span class="p">(</span><span class="n">delta_num</span><span class="p">[,</span> <span class="p">[</span><span class="n">db_name</span><span class="p">.]</span><span class="k">table_name</span><span class="p">[,</span> <span class="n">square</span><span class="o">-</span><span class="n">bracketed_column_list</span><span class="p">]])</span>
</code></pre></div></div>

<h2 id="параметры">Параметры</h2>

<ul>
  <li><code class="language-sql highlighter-rouge"><span class="n">delta_num</span></code> — номер горячей или закрытой <a href="../../../Обзор_понятий_компонентов_и_связей/Основные_понятия/Дельта/Дельта.md">дельты</a>, 
в рамках которой вычисляется контрольная сумма. Если других аргументов не указано, контрольная сумма 
вычисляется для данных, хранимых во всех <a href="../../../Обзор_понятий_компонентов_и_связей/Основные_понятия/Логическая_таблица/Логическая_таблица.md">логических таблицах</a> 
<a href="../../../Обзор_понятий_компонентов_и_связей/Основные_понятия/Логическая_база_данных/Логическая_база_данных.md">логической БД</a>, 
<a href="../../../Работа_с_системой/Другие_функции/Определение_логической_БД_по_умолчанию/Определение_логической_БД_по_умолчанию.md">используемой по умолчанию</a>;</li>
  <li><code class="language-sql highlighter-rouge"><span class="k">table_name</span></code> — опционально указываемое имя логической таблицы, для данных которой вычисляется 
контрольная сумма;</li>
  <li><code class="language-sql highlighter-rouge"><span class="n">square</span><span class="o">-</span><span class="n">bracketed_column_list</span></code> — опциональный список имён столбцов указанной логической таблицы, 
для данных которых вычисляется контрольная сумма. Элементы списка перечисляются внутри квадратных 
скобок через запятую. Если список столбцов не указан, контрольная сумма вычисляется по всем столбцам 
логической таблицы.</li>
</ul>

<h2 id="ограничения">Ограничения</h2>

<ul>
  <li>Не предоставляется строгой гарантии отсутствия ложноположительных результатов проверки контрольной 
суммы.</li>
</ul>

<h2 id="примеры">Примеры</h2>

<p>Проверка контрольной суммы логической базы данных <code class="language-sql highlighter-rouge"><span class="n">sales</span></code> в рамках нулевой дельты:</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">USE</span> <span class="n">sales</span>
<span class="n">CHECK_SUM</span><span class="p">(</span><span class="mi">0</span><span class="p">)</span>
</code></pre></div></div>

<p>Проверка контрольной суммы столбцов логической таблицы <code class="language-sql highlighter-rouge"><span class="n">stores</span></code> в рамках нулевой дельты:</p>
<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="n">CHECK_SUM</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="n">sales</span><span class="p">.</span><span class="n">stores</span><span class="p">,[</span><span class="n">region</span><span class="p">,</span> <span class="n">address</span><span class="p">])</span>
</code></pre></div></div>
