<h1 id="create-upload-external-table">CREATE UPLOAD EXTERNAL TABLE</h1>

<p>Запрос позволяет создать <a href="../../../Обзор_понятий_компонентов_и_связей/Основные_понятия/Внешняя_таблица/Внешняя_таблица.md">внешнюю таблицу</a> 
загрузки в <a href="../../../Обзор_понятий_компонентов_и_связей/Основные_понятия/Логическая_база_данных/Логическая_база_данных.md">логической базе данных</a>.</p>

<p>В ответе возвращается:</p>
<ul>
  <li>пустой объект ResultSet при успешном выполнении запроса;</li>
  <li>исключение при неуспешном выполнении запроса.</li>
</ul>

<p>После успешного выполнения запроса можно выполнять запросы 
<a href="../INSERT_INTO_logical_table/INSERT_INTO_logical_table.md">INSERT INTO logical_table</a> на загрузку данных. Подробнее о порядке 
выполнения действий для загрузки данных см. в разделе 
<a href="../../../Работа_с_системой/Загрузка_данных/Загрузка_данных.md">Загрузка данных</a>.</p>

<p><strong>Примечание:</strong> изменение внешней таблицы недоступно. Для замены некорректной внешней таблицы необходимо 
удалить ее и создать новую.</p>

<h2 id="синтаксис">Синтаксис</h2>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="n">UPLOAD</span> <span class="k">EXTERNAL</span> <span class="k">TABLE</span> <span class="p">[</span><span class="n">db_name</span><span class="p">.]</span><span class="n">ext_table_name</span> <span class="p">(</span>
  <span class="n">column_name_1</span> <span class="n">datatype_1</span><span class="p">,</span>
  <span class="n">column_name_2</span> <span class="n">datatype_2</span><span class="p">,</span>
  <span class="n">column_name_3</span> <span class="n">datatype_3</span>
<span class="p">)</span>
<span class="k">LOCATION</span> <span class="n">source_URI</span>
<span class="n">FORMAT</span> <span class="s1">'AVRO'</span>
<span class="p">[</span><span class="n">MESSAGE_LIMIT</span> <span class="n">messages_per_segment</span><span class="p">]</span>
</code></pre></div></div>

<h2 id="параметры">Параметры</h2>

<ul>
  <li><code class="language-sql highlighter-rouge"><span class="n">db_name</span></code> — имя логической базы данных, в которой создается внешняя таблица. Указание опционально, 
если выбрана логическая БД, <a href="../../../Работа_с_системой/Другие_функции/Определение_логической_БД_по_умолчанию/Определение_логической_БД_по_умолчанию.md">используемая по умолчанию</a>;</li>
  <li><code class="language-sql highlighter-rouge"><span class="n">ext_table_name</span></code> — имя создаваемой внешней таблицы загрузки. Для удобства различения таблиц выгрузки 
и таблиц загрузки рекомендуется задавать имя таблицы, указывающее на ее тип, например 
<code class="language-sql highlighter-rouge"><span class="n">sales_ext_upload</span></code>;</li>
  <li><code class="language-sql highlighter-rouge"><span class="n">column_name_N</span></code> — имя столбца таблицы;</li>
  <li><code class="language-sql highlighter-rouge"><span class="n">datatype_N</span></code> — тип данных столбца <code class="language-sql highlighter-rouge"><span class="n">column_name_N</span></code>. Возможные значения см. в разделе 
<a href="../../Поддерживаемые_типы_данных/Логические_типы_данных/Логические_типы_данных.md">Логические типы данных</a>;</li>
  <li><code class="language-sql highlighter-rouge"><span class="n">source_URI</span></code> — путь к топику Kafka 
(см. <a href="../../Формат_пути_к_внешнему_приемнику_данных/Формат_пути_к_внешнему_приемнику_данных.md">Формат пути к внешнему приемнику данных</a>);</li>
  <li><code class="language-sql highlighter-rouge"><span class="n">messages_per_segment</span></code> — максимальное количество сообщений, загружаемых 
в <a href="../../../Обзор_понятий_компонентов_и_связей/Основные_понятия/Хранилище_данных/Хранилище_данных.md">хранилище</a> 
в составе одного блока на один поток загрузки. Значение подбирается в зависимости от параметров 
производительности инфраструктуры.</li>
</ul>

<h2 id="пример">Пример</h2>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="n">UPLOAD</span> <span class="k">EXTERNAL</span> <span class="k">TABLE</span> <span class="n">sales</span><span class="p">.</span><span class="n">sales_ext_upload</span> <span class="p">(</span>
  <span class="n">identification_number</span> <span class="nb">INT</span><span class="p">,</span>
  <span class="n">transaction_date</span> <span class="nb">TIMESTAMP</span><span class="p">,</span>
  <span class="n">product_code</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">),</span>
  <span class="n">product_units</span> <span class="nb">INT</span><span class="p">,</span>
  <span class="n">store_id</span> <span class="nb">INT</span><span class="p">,</span>
  <span class="n">description</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">LOCATION</span>  <span class="s1">'kafka://zk1:2181,zk2:2181,zk3:2181/sales'</span>
<span class="n">FORMAT</span> <span class="s1">'AVRO'</span>
<span class="n">MESSAGE_LIMIT</span> <span class="mi">1000</span>
</code></pre></div></div>
