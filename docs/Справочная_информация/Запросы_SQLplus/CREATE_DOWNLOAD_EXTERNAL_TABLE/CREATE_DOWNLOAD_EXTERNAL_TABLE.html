<h1 id="create-download-external-table">CREATE DOWNLOAD EXTERNAL TABLE</h1>

<p>Запрос позволяет создать <a href="../../../Обзор_понятий_компонентов_и_связей/Основные_понятия/Внешняя_таблица/Внешняя_таблица.md">внешнюю таблицу</a> 
выгрузки в <a href="../../../Обзор_понятий_компонентов_и_связей/Основные_понятия/Логическая_база_данных/Логическая_база_данных.md">логической базе данных</a>.</p>

<p>В ответе возвращается:</p>
<ul>
  <li>пустой объект ResultSet при успешном выполнении запроса;</li>
  <li>исключение при неуспешном выполнении запроса.</li>
</ul>

<p>После успешного выполнения запроса можно выполнять запросы 
<a href="../INSERT_INTO_download_external_table/INSERT_INTO_download_external_table.md">INSERT INTO download_external_table</a> на выгрузку данных. 
Подробнее о порядке выполнения действий для выгрузки данных см. в разделе 
<a href="../../../Работа_с_системой/Выгрузка_данных/Выгрузка_данных.md">Выгрузка данных</a>.</p>

<p><strong>Примечание:</strong> изменение внешней таблицы недоступно. Для замены некорректной внешней таблицы необходимо 
удалить ее и создать новую.</p>

<h2 id="синтаксис">Синтаксис</h2>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="n">DOWNLOAD</span> <span class="k">EXTERNAL</span> <span class="k">TABLE</span> <span class="p">[</span><span class="n">db_name</span><span class="p">.]</span><span class="n">ext_table_name</span><span class="p">(</span>
  <span class="n">column_name_1</span> <span class="n">datatype_1</span><span class="p">,</span>
  <span class="n">column_name_2</span> <span class="n">datatype_2</span><span class="p">,</span>
  <span class="n">column_name_3</span> <span class="n">datatype_3</span>
<span class="p">)</span>
<span class="k">LOCATION</span> <span class="n">receiver_URI</span>
<span class="n">FORMAT</span> <span class="s1">'AVRO'</span>
<span class="p">[</span><span class="n">CHUNK_SIZE</span> <span class="n">records_per_message</span><span class="p">]</span>
</code></pre></div></div>

<h2 id="параметры">Параметры</h2>

<ul>
  <li><code class="language-sql highlighter-rouge"><span class="n">db_name</span></code> — имя логической базы данных, в которой создается внешняя таблица. Указывается опционально, 
если выбрана логическая БД, <a href="../../../Работа_с_системой/Другие_функции/Определение_логической_БД_по_умолчанию/Определение_логической_БД_по_умолчанию.md">используемая по умолчанию</a>;</li>
  <li><code class="language-sql highlighter-rouge"><span class="n">ext_table_name</span></code> — имя создаваемой внешней таблицы выгрузки. Для удобства различения таблиц выгрузки 
и таблиц загрузки рекомендуется задавать имя таблицы, указывающее на ее тип, например 
<code class="language-sql highlighter-rouge"><span class="n">sales_ext_download</span></code>;</li>
  <li><code class="language-sql highlighter-rouge"><span class="n">column_name_N</span></code> — имя столбца таблицы;</li>
  <li><code class="language-sql highlighter-rouge"><span class="n">datatype_N</span></code> — тип данных столбца <code class="language-sql highlighter-rouge"><span class="n">column_name_N</span></code>. Возможные значения см. в разделе 
<a href="../../Поддерживаемые_типы_данных/Логические_типы_данных/Логические_типы_данных.md">Логические типы данных</a>;</li>
  <li><code class="language-sql highlighter-rouge"><span class="n">receiver_URI</span></code> — путь к топику Kafka 
(см. <a href="../../Формат_пути_к_внешнему_приемнику_данных/Формат_пути_к_внешнему_приемнику_данных.md">Формат пути к внешнему приемнику данных</a>);</li>
  <li><code class="language-sql highlighter-rouge"><span class="n">records_per_message</span></code> — максимальное количество записей, выгружаемых из хранилища в одном сообщении 
топика Каfka.</li>
</ul>

<h2 id="пример">Пример</h2>

<div class="language-sql highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="k">CREATE</span> <span class="n">DOWNLOAD</span> <span class="k">EXTERNAL</span> <span class="k">TABLE</span> <span class="n">sales</span><span class="p">.</span><span class="n">sales_ext_download</span> <span class="p">(</span>
  <span class="n">identification_number</span> <span class="nb">INT</span><span class="p">,</span>
  <span class="n">transaction_date</span> <span class="nb">TIMESTAMP</span><span class="p">,</span>
  <span class="n">product_code</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">),</span>
  <span class="n">product_units</span> <span class="nb">INT</span><span class="p">,</span>
  <span class="n">store_id</span> <span class="nb">INT</span><span class="p">,</span>
  <span class="n">description</span> <span class="nb">VARCHAR</span><span class="p">(</span><span class="mi">256</span><span class="p">)</span>
<span class="p">)</span>
<span class="k">LOCATION</span>  <span class="s1">'kafka://zk1:2181,zk2:2181,zk3:2181/sales_out'</span>
<span class="n">FORMAT</span> <span class="s1">'AVRO'</span>
<span class="n">CHUNK_SIZE</span> <span class="mi">1000</span>
</code></pre></div></div>
